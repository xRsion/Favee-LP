<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex">
    <title>Favee „Çπ„Ç±„Ç∏„É•„Éº„É´ÁÆ°ÁêÜ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans JP', sans-serif;
        }
        .gradient-bg {
            background: linear-gradient(135deg, #f472b6 0%, #fbbf24 100%);
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="min-h-screen">
        <!-- Header -->
        <header class="gradient-bg text-white py-6">
            <div class="container mx-auto px-4">
                <h1 class="text-3xl font-bold">Favee „Çπ„Ç±„Ç∏„É•„Éº„É´ÁÆ°ÁêÜ</h1>
                <p class="mt-2 opacity-90">„Ç§„Éô„É≥„Éà„Éª„Ç¢„ÉÉ„Éó„Éá„Éº„Éà„Éª„Ç≥„É©„ÉúÊÉÖÂ†±„ÅÆÁÆ°ÁêÜ</p>
            </div>
        </header>

        <div class="container mx-auto px-4 py-8">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- „Ç§„Éô„É≥„ÉàËøΩÂä†„Éï„Ç©„Éº„É† -->
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h2 class="text-2xl font-bold mb-6 text-gray-800">Êñ∞„Åó„ÅÑ„Ç§„Éô„É≥„Éà„ÇíËøΩÂä†</h2>
                    <form id="event-form" class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">„Çø„Ç§„Éà„É´</label>
                            <input type="text" id="title" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-pink-500" required>
                        </div>

                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">„Ç´„ÉÜ„Ç¥„É™</label>
                                <select id="category" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-pink-500" required>
                                    <option value="update">üì± „Ç¢„ÉÉ„Éó„Éá„Éº„Éà</option>
                                    <option value="event">üéâ „Ç§„Éô„É≥„Éà</option>
                                    <option value="collab">ü§ù „Ç≥„É©„Éú</option>
                                    <option value="maintenance">üîß „É°„É≥„ÉÜ„Éä„É≥„Çπ</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">„Çπ„ÉÜ„Éº„Çø„Çπ</label>
                                <select id="status" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-pink-500" required>
                                    <option value="upcoming">‰∫àÂÆö</option>
                                    <option value="ongoing">ÈñãÂÇ¨‰∏≠</option>
                                    <option value="completed">ÁµÇ‰∫Ü</option>
                                </select>
                            </div>
                        </div>

                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Êó•‰ªòË°®Á§∫</label>
                                <input type="text" id="date" placeholder="2025Âπ¥7Êúà15Êó•ÔºàÁÅ´Ôºâ10:00„Äú12:00" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-pink-500" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">„ÇΩ„Éº„ÉàÁî®Êó•‰ªò</label>
                                <input type="date" id="dateSort" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-pink-500" required>
                            </div>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">„Ç¢„Ç§„Ç≥„É≥</label>
                            <input type="text" id="icon" placeholder="üì±" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-pink-500" required>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ë©≥Á¥∞ÂÜÖÂÆπÔºà1Ë°å„Åö„Å§ÂÖ•ÂäõÔºâ</label>
                            <textarea id="details" rows="4" placeholder="Êñ∞„Åó„ÅÑ„Ç¢„Éê„Çø„ÉºÁùÄ„ÅõÊõø„Åà„Ç∑„Çπ„ÉÜ„É†&#10;ÈÉ®Â±ã„ÅÆ„Ç´„Çπ„Çø„Éû„Ç§„Ç∫Ê©üËÉΩÂº∑Âåñ" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-pink-500" required></textarea>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Ê≥®ÊÑèÊõ∏„Åç„ÉªÁâπË®ò‰∫ãÈ†Ö</label>
                            <input type="text" id="note" placeholder="üí° „Ç¢„ÉÉ„Éó„Éá„Éº„ÉàË®òÂøµ„ÅßÈôêÂÆö„Ç¢„Ç§„ÉÜ„É†„Éó„É¨„Çº„É≥„ÉàÔºÅ" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-pink-500">
                        </div>

                        <div class="flex gap-4">
                            <button type="submit" class="flex-1 gradient-bg text-white py-2 px-4 rounded-md hover:opacity-90 transition-opacity">
                                „Ç§„Éô„É≥„Éà„ÇíËøΩÂä†
                            </button>
                            <button type="button" id="clear-form" class="px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors">
                                „ÇØ„É™„Ç¢
                            </button>
                        </div>
                    </form>
                </div>

                <!-- „Ç§„Éô„É≥„Éà‰∏ÄË¶ß„ÉªÁ∑®ÈõÜ -->
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">„Ç§„Éô„É≥„Éà‰∏ÄË¶ß</h2>
                        <div class="flex gap-2">
                            <button id="export-btn" class="px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors text-sm">
                                „Ç®„ÇØ„Çπ„Éù„Éº„Éà
                            </button>
                            <button id="import-btn" class="px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600 transition-colors text-sm">
                                „Ç§„É≥„Éù„Éº„Éà
                            </button>
                        </div>
                    </div>
                    
                    <div id="events-list" class="space-y-4 max-h-96 overflow-y-auto">
                        <!-- „Ç§„Éô„É≥„Éà‰∏ÄË¶ß„Åå„Åì„Åì„Å´Ë°®Á§∫„Åï„Çå„Åæ„Åô -->
                    </div>
                </div>
            </div>

            <!-- „Éó„É¨„Éì„É•„Éº„Çª„ÇØ„Ç∑„Éß„É≥ -->
            <div class="mt-8 bg-white rounded-lg shadow-lg p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-800">„Éó„É¨„Éì„É•„Éº</h2>
                    <a href="schedule.html" target="_blank" class="px-4 py-2 gradient-bg text-white rounded-md hover:opacity-90 transition-opacity">
                        „Çπ„Ç±„Ç∏„É•„Éº„É´„Éö„Éº„Ç∏„ÇíÈñã„Åè
                    </a>
                </div>
                <p class="text-gray-600">Â§âÊõ¥„ÅØËá™ÂãïÁöÑ„Å´„Çπ„Ç±„Ç∏„É•„Éº„É´„Éö„Éº„Ç∏„Å´ÂèçÊò†„Åï„Çå„Åæ„Åô„ÄÇ</p>
            </div>
        </div>
    </div>

    <!-- „Ç§„É≥„Éù„Éº„ÉàÁî®„É¢„Éº„ÉÄ„É´ -->
    <div id="import-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-lg p-6 max-w-2xl w-full mx-4">
            <h3 class="text-xl font-bold mb-4">JSON„Éá„Éº„Çø„Çí„Ç§„É≥„Éù„Éº„Éà</h3>
            <textarea id="import-data" rows="10" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-pink-500" placeholder="JSON„Éá„Éº„Çø„Çí„Åì„Åì„Å´Ë≤º„Çä‰ªò„Åë„Å¶„Åè„Å†„Åï„ÅÑ..."></textarea>
            <div class="flex justify-end gap-4 mt-4">
                <button id="cancel-import" class="px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors">
                    „Ç≠„É£„É≥„Çª„É´
                </button>
                <button id="confirm-import" class="px-4 py-2 gradient-bg text-white rounded-md hover:opacity-90 transition-opacity">
                    „Ç§„É≥„Éù„Éº„Éà
                </button>
            </div>
        </div>
    </div>

    <script src="assets/js/schedule.js"></script>
    <script>
        class AdminManager {
            constructor() {
                this.currentEditId = null;
                this.init();
            }

            async init() {
                // „Çπ„Ç±„Ç∏„É•„Éº„É´„Éû„Éç„Éº„Ç∏„É£„Éº„ÅÆÂàùÊúüÂåñ„ÇíÂæÖ„Å§
                if (window.scheduleManager) {
                    this.scheduleManager = window.scheduleManager;
                } else {
                    // „Çπ„Ç±„Ç∏„É•„Éº„É´„Éû„Éç„Éº„Ç∏„É£„Éº„ÅåË™≠„ÅøËæº„Åæ„Çå„Çã„Åæ„ÅßÂæÖ„Å§
                    await new Promise(resolve => {
                        const checkManager = () => {
                            if (window.scheduleManager) {
                                this.scheduleManager = window.scheduleManager;
                                resolve();
                            } else {
                                setTimeout(checkManager, 100);
                            }
                        };
                        checkManager();
                    });
                }

                this.setupEventListeners();
                this.renderEventsList();
            }

            setupEventListeners() {
                // „Éï„Ç©„Éº„É†ÈÄÅ‰ø°
                document.getElementById('event-form').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.handleFormSubmit();
                });

                // „Éï„Ç©„Éº„É†„ÇØ„É™„Ç¢
                document.getElementById('clear-form').addEventListener('click', () => {
                    this.clearForm();
                });

                // „Ç®„ÇØ„Çπ„Éù„Éº„Éà
                document.getElementById('export-btn').addEventListener('click', () => {
                    this.exportData();
                });

                // „Ç§„É≥„Éù„Éº„Éà
                document.getElementById('import-btn').addEventListener('click', () => {
                    this.showImportModal();
                });

                // „É¢„Éº„ÉÄ„É´Èñ¢ÈÄ£
                document.getElementById('cancel-import').addEventListener('click', () => {
                    this.hideImportModal();
                });

                document.getElementById('confirm-import').addEventListener('click', () => {
                    this.handleImport();
                });
            }

            handleFormSubmit() {
                const formData = this.getFormData();
                
                if (this.currentEditId) {
                    // Á∑®ÈõÜ„É¢„Éº„Éâ
                    this.scheduleManager.updateEvent(this.currentEditId, formData);
                    this.currentEditId = null;
                } else {
                    // Êñ∞Ë¶èËøΩÂä†„É¢„Éº„Éâ
                    this.scheduleManager.addEvent(formData);
                }

                this.clearForm();
                this.renderEventsList();
                this.saveToFile();
            }

            getFormData() {
                const categoryConfig = {
                    update: { iconBg: 'bg-blue-500', noteBg: 'bg-blue-50', noteColor: 'text-blue-800' },
                    event: { iconBg: 'bg-red-500', noteBg: 'bg-red-50', noteColor: 'text-red-800' },
                    collab: { iconBg: 'bg-green-500', noteBg: 'bg-green-50', noteColor: 'text-green-800' },
                    maintenance: { iconBg: 'bg-yellow-500', noteBg: 'bg-yellow-50', noteColor: 'text-yellow-800' }
                };

                const category = document.getElementById('category').value;
                const config = categoryConfig[category];
                const details = document.getElementById('details').value.split('\n').filter(line => line.trim());

                return {
                    title: document.getElementById('title').value,
                    category: category,
                    status: document.getElementById('status').value,
                    date: document.getElementById('date').value,
                    dateSort: document.getElementById('dateSort').value,
                    icon: document.getElementById('icon').value,
                    iconBg: config.iconBg,
                    description: category === 'maintenance' ? '„É°„É≥„ÉÜ„Éä„É≥„ÇπÂÜÖÂÆπÔºö' : 
                                category === 'collab' ? '„Ç≥„É©„ÉúÂÜÖÂÆπÔºö' : 
                                category === 'event' ? '„Ç§„Éô„É≥„ÉàÂÜÖÂÆπÔºö' : 'Êñ∞Ê©üËÉΩ„ÉªÊîπÂñÑÁÇπÔºö',
                    details: details,
                    note: document.getElementById('note').value || null,
                    noteBg: config.noteBg,
                    noteColor: config.noteColor
                };
            }

            clearForm() {
                document.getElementById('event-form').reset();
                this.currentEditId = null;
                document.querySelector('button[type="submit"]').textContent = '„Ç§„Éô„É≥„Éà„ÇíËøΩÂä†';
            }

            renderEventsList() {
                const container = document.getElementById('events-list');
                const events = this.scheduleManager.events;

                container.innerHTML = events.map(event => `
                    <div class="border border-gray-200 rounded-lg p-4">
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <h3 class="font-semibold text-gray-800">${event.title}</h3>
                                <p class="text-sm text-gray-600">${event.date}</p>
                                <div class="flex gap-2 mt-2">
                                    <span class="text-xs px-2 py-1 bg-gray-100 rounded">${event.category}</span>
                                    <span class="text-xs px-2 py-1 bg-gray-100 rounded">${event.status}</span>
                                </div>
                            </div>
                            <div class="flex gap-2">
                                <button onclick="adminManager.editEvent(${event.id})" class="text-blue-500 hover:text-blue-700 text-sm">
                                    Á∑®ÈõÜ
                                </button>
                                <button onclick="adminManager.deleteEvent(${event.id})" class="text-red-500 hover:text-red-700 text-sm">
                                    ÂâäÈô§
                                </button>
                            </div>
                        </div>
                    </div>
                `).join('');
            }

            editEvent(id) {
                const event = this.scheduleManager.events.find(e => e.id === id);
                if (!event) return;

                // „Éï„Ç©„Éº„É†„Å´ÂÄ§„ÇíË®≠ÂÆö
                document.getElementById('title').value = event.title;
                document.getElementById('category').value = event.category;
                document.getElementById('status').value = event.status;
                document.getElementById('date').value = event.date;
                document.getElementById('dateSort').value = event.dateSort;
                document.getElementById('icon').value = event.icon;
                document.getElementById('details').value = event.details.join('\n');
                document.getElementById('note').value = event.note || '';

                this.currentEditId = id;
                document.querySelector('button[type="submit"]').textContent = '„Ç§„Éô„É≥„Éà„ÇíÊõ¥Êñ∞';
            }

            deleteEvent(id) {
                if (confirm('„Åì„ÅÆ„Ç§„Éô„É≥„Éà„ÇíÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü')) {
                    this.scheduleManager.deleteEvent(id);
                    this.renderEventsList();
                    this.saveToFile();
                }
            }

            exportData() {
                const data = this.scheduleManager.exportEvents();
                const blob = new Blob([data], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'events.json';
                a.click();
                URL.revokeObjectURL(url);
            }

            showImportModal() {
                document.getElementById('import-modal').classList.remove('hidden');
                document.getElementById('import-modal').classList.add('flex');
            }

            hideImportModal() {
                document.getElementById('import-modal').classList.add('hidden');
                document.getElementById('import-modal').classList.remove('flex');
                document.getElementById('import-data').value = '';
            }

            async handleImport() {
                const data = document.getElementById('import-data').value;
                if (await this.scheduleManager.importEvents(data)) {
                    this.renderEventsList();
                    this.saveToFile();
                    this.hideImportModal();
                    alert('„Ç§„É≥„Éù„Éº„Éà„ÅåÂÆå‰∫Ü„Åó„Åæ„Åó„ÅüÔºÅ');
                } else {
                    alert('„Ç§„É≥„Éù„Éº„Éà„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇJSON„Éá„Éº„Çø„ÇíÁ¢∫Ë™ç„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ');
                }
            }

            async saveToFile() {
                // ÂÆüÈöõ„ÅÆ„Éï„Ç°„Ç§„É´‰øùÂ≠ò„ÅØÊâãÂãï„ÅßË°å„ÅÜÂøÖË¶Å„Åå„ÅÇ„Çä„Åæ„Åô
                console.log('„Ç§„Éô„É≥„Éà„Éá„Éº„Çø„ÅåÊõ¥Êñ∞„Åï„Çå„Åæ„Åó„Åü„ÄÇassets/data/events.json „ÇíÊâãÂãï„ÅßÊõ¥Êñ∞„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ');
                console.log(this.scheduleManager.exportEvents());
            }
        }

        // ÂàùÊúüÂåñ
        document.addEventListener('DOMContentLoaded', () => {
            window.adminManager = new AdminManager();
        });
    </script>
</body>
</html>